"use strict";(function($,Drupal){Drupal.behaviors.smile_store_locator={_getCookie:function _getCookie(){var name="Drupal.visitor.diagnostic_state=";var ca=decodeURIComponent(document.cookie).split(';');var diagcookie='';for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===' '){c=c.substring(1);}
if(c.indexOf(name)===0){diagcookie=c.substring(name.length,c.length);diagcookie=JSON.parse(diagcookie);}}
return diagcookie;},addPostalCodeToUrl:function addPostalCodeToUrl(self,context){$('a[href="/ou-nous-trouver/"]',context).each(function(index,element){try{var customization='';var diagcookie=self._getCookie();if(diagcookie.cible==='particulier'){customization+='services='+diagcookie.cible.toUpperCase();if(diagcookie.code_postal!==''){customization+='&q='+diagcookie.code_postal;}}
if(customization!==''){customization='#/s?'+customization;element.href=element.href+customization;}}catch(error){console.error(error);}});},bindAjaxStoreLocator:function bindAjaxStoreLocator(element){jQuery(element).find('.ubsf_details-cta.ubsf_store-finder-button').once('ajax').each(function(i,ajaxLink){var $linkElement=$(ajaxLink);var elementSettings={progress:{type:'none'},dialogType:$linkElement.data('dialog-type'),dialog:$linkElement.data('dialog-options'),dialogRenderer:$linkElement.data('dialog-renderer'),base:$linkElement.attr('id'),element:ajaxLink};var last_url_part=jQuery(location).attr('href').split("/").pop();elementSettings.url='/panel/store/'+last_url_part;elementSettings.event='click';console.log(elementSettings);Drupal.ajax(elementSettings);});},attach:function attach(context,settings){var self=this;var ubInterval=setInterval(function(){if(window.location.href&&window.location.href.indexOf('ou-nous-trouver')>0){var ctas=$('.ubsf_details-cta');if(ctas.length>0){self.bindAjaxStoreLocator(document.body);}}else{clearInterval(ubInterval);}},500);self.addPostalCodeToUrl(self,context);}};})(jQuery,Drupal);